function renderCalendar(n){let i={};days.forEach(n=>i[n]=[]);n.forEach(n=>{const t=days[n.dayOfWeek];i[t].push(n)});let t='<table class="table table-bordered"><thead><tr>';days.forEach(n=>t+=`<th>${n}</th>`);t+="<\/tr><\/thead><tbody><tr>";days.forEach(n=>{t+="<td>",i[n].length===0?t+='<span class="text-muted">No flights<\/span>':i[n].forEach(n=>{t+=`<div class="mb-2"><strong>Dep: </strong>${n.departureTime}<br/><strong> Duration: </strong>${n.flightDuration}</div>`}),t+="<\/td>"});t+="<\/tr><\/tbody><\/table>";$("#weekly-calendar").html(t)}function fetchFlights(n){if(!n||n=="0"){$("#weekly-calendar").html("");return}$.get(`/airplanes/${n}/flights`,function(n){renderCalendar(n.flights)})}function fetchPricePerHour(n){if(!n||n=="0"){airplanePricePerHour=null;return}$.get(`/airplanes/${n}/price-per-hour`,function(n){airplanePricePerHour=parseFloat(n);airplanePricePerHour>0&&updatePriceIfValid()})}function parseTimeSpanToHours(n){if(!n)return 0;let i=0,r=n;if(n.includes(".")){const t=n.split(".");i=parseInt(t[0],10)||0;r=t[1]}const t=r.split(":");if(t.length<2)return 0;const u=parseInt(t[0],10)||0,f=parseInt(t[1],10)||0;return i*24+u+f/60}function updatePriceIfValid(){const n=$("#FlightDuration"),t=n.closest("form");if(n.length&&airplanePricePerHour!==null&&t.length&&t.validate().element(n)){const t=parseTimeSpanToHours(n.val());if(t>0){const n=(t*airplanePricePerHour).toFixed(2);$("#Price").val(n)}}}const days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];let airplanePricePerHour=null;$(function(){const n=$("#AirplaneId").val();n&&(fetchFlights(n),fetchPricePerHour(n));$("#AirplaneId").on("change",function(){fetchFlights($(this).val());fetchPricePerHour($(this).val())});$("#FlightDuration").on("change blur",function(){updatePriceIfValid()})});