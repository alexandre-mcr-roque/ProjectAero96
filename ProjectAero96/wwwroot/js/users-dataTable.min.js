$(function(){function t(n){const t=$("#show-disabled").is(":checked");return n.users.filter(function(n){return t||!n.deleted})}let n=$("#table-users").DataTable({layout:{topStart:["pageLength",{div:{className:"dataTable-feature",id:"create-user-container",html:'<a href="/admin/users/create" class="btn btn-sm btn-primary" role="button">Create new User<\/a>'}}],topEnd:[{div:{className:"dataTable-feature",id:"role-selectbox"}},{search:{text:"Search user: _INPUT_"}}],top2End:{div:{className:"dataTable-feature",id:"show-disabled-container",html:'<label for="show-disabled" class="form-check-label me-2">Show disabled users<\/label><input type="checkbox" id="show-disabled" class="form-check-input">'}}},ajax:{url:"/admin/users/getall",dataSrc:t},processing:!0,columnDefs:[{className:"align-middle",targets:"_all"}],columns:[{data:"fullName"},{data:"email"},{data:"roles",orderable:!1},{orderable:!1,searchable:!1,width:"8em",data:"id",render:function(n,t,i){return i.deleted?'<div class="text-center">'+`<a class="btn btn-sm btn-primary m-1" href="/admin/users/edit/${n}" role="button"><i class="fa-solid fa-user-pen"></i></a>`+`<button class="btn btn-sm btn-success m-1" id="restore-modal-toggle" restore-target="${n}"><i class="fa-solid fa-user-plus"></i></button>`+"<\/div>":'<div class="text-center">'+`<a class="btn btn-sm btn-primary m-1" href="/admin/users/edit/${n}" role="button"><i class="fa-solid fa-user-pen"></i></a>`+`<button class="btn btn-sm btn-danger m-1" id="disable-modal-toggle" disable-target="${n}"><i class="fa-solid fa-user-xmark"></i></button>`+"<\/div>"}}],rowCallback:function(n,t){t.deleted&&$(n).addClass("row-disabled")}});n.processing(!1);$("#show-disabled").on("change",function(){n.ajax.reload()});$("#role-selectbox").append('<label for="role-select">Filter by role:<\/label>').append($("<select><\/select>",{id:"role-select","class":"form-select form-select-sm",html:'<option value="" selected>None<\/option><option value="Client">Client<\/option><option value="Employee">Employee<\/option><option value="Admin">Admin<\/option>',on:{change:function(){$("#table-users").DataTable().column(2).search($(this).val()).draw()}}}));$("#table-users").on("click",'button[id="disable-modal-toggle"]',function(){let n=$(this).attr("disable-target");$("#disable-userid").val(n);$("#disable-modal").modal("show")});$("#confirm-disable").on("click",function(){let t=$("#disable-userid").val(),i=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:`/admin/users/disable/${t}`,type:"POST",headers:{RequestVerificationToken:i},success:function(){n.ajax.reload()},error:function(n){alert(`Error disabling user: ${n.responseText}`)},complete:function(){$("#disable-modal").modal("hide")}})});$("#table-users").on("click",'button[id="restore-modal-toggle"]',function(){let n=$(this).attr("restore-target");$("#restore-userid").val(n);$("#restore-modal").modal("show")});$("#confirm-restore").on("click",function(){let t=$("#restore-userid").val(),i=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:`/admin/users/restore/${t}`,type:"POST",headers:{RequestVerificationToken:i},success:function(){n.ajax.reload()},error:function(n){alert(`Error restoring user: ${n.responseText}`)},complete:function(){$("#restore-modal").modal("hide")}})})});