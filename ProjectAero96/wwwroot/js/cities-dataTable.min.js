$(function(){function t(n){let t=$("#show-disabled").is(":checked");return n.cities.filter(function(n){return t||!n.deleted})}let n=$("#table-cities").DataTable({layout:{topStart:["pageLength",{div:{className:"dataTable-feature",id:"create-city-container",html:'<a href="/admin/cities/create" class="btn btn-sm btn-primary" role="button">Create new City<\/a>'}}],topEnd:{search:{text:"Search city: _INPUT_"}},top2End:{div:{className:"dataTable-feature",id:"show-disabled-container",html:'<label for="show-disabled" class="form-check-label me-2">Show disabled cities<\/label><input type="checkbox" id="show-disabled" class="form-check-input">'}}},ajax:{url:"/admin/cities/getall",dataSrc:t},processing:!0,columnDefs:[{className:"align-middle",targets:"_all"}],columns:[{data:"name"},{data:"country"},{orderable:!1,searchable:!1,width:"8em",data:"id",render:function(n,t,i){return i.deleted?'<div class="text-center">'+`<a class="btn btn-sm btn-primary m-1" href="/admin/cities/edit/${n}" role="button"><i class="fa-solid fa-pen"></i></a>`+`<button class="btn btn-sm btn-success m-1" id="restore-modal-toggle" restore-target="${n}"><i class="fa-solid fa-plus"></i></button>`+"<\/div>":'<div class="text-center">'+`<a class="btn btn-sm btn-primary m-1" href="/admin/cities/edit/${n}" role="button"><i class="fa-solid fa-pen"></i></a>`+`<button class="btn btn-sm btn-danger m-1" id="disable-modal-toggle" disable-target="${n}"><i class="fa-solid fa-xmark"></i></button>`+"<\/div>"}}],rowCallback:function(n,t){t.deleted&&$(n).addClass("row-disabled")}});n.processing(!1);$("#show-disabled").on("change",function(){n.ajax.reload()});$("#table-cities").on("click",'button[id="disable-modal-toggle"]',function(){let n=$(this).attr("disable-target");$("#disable-cityid").val(n);$("#disable-modal").modal("show")});$("#confirm-disable").on("click",function(){let t=$("#disable-cityid").val(),i=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:`/admin/cities/disable/${t}`,type:"POST",headers:{RequestVerificationToken:i},success:function(){n.ajax.reload()},error:function(n){alert(`Error disabling city: ${n.responseText}`)},complete:function(){$("#disable-modal").modal("hide")}})});$("#table-cities").on("click",'button[id="restore-modal-toggle"]',function(){let n=$(this).attr("restore-target");$("#restore-cityid").val(n);$("#restore-modal").modal("show")});$("#confirm-restore").on("click",function(){let t=$("#restore-cityid").val(),i=$('input[name="__RequestVerificationToken"]').val();$.ajax({url:`/admin/cities/restore/${t}`,type:"POST",headers:{RequestVerificationToken:i},success:function(){n.ajax.reload()},error:function(n){alert(`Error restoring city: ${n.responseText}`)},complete:function(){$("#restore-modal").modal("hide")}})})});